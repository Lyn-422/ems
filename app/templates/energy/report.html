{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h3>日能耗成本分析报表</h3>
    <form class="d-flex align-items-center" method="GET">
        <select name="plant_id" class="form-select me-2" style="width: 200px;" required>
            <option value="" disabled selected>选择厂区...</option>
            {% for plant in plants %}
            <option value="{{ plant.plant_id }}">{{ plant.plant_name }}</option>
            {% endfor %}
        </select>
        <input type="date" name="date" class="form-control me-2" required>
        <button type="submit" class="btn btn-primary">生成/查询</button>
    </form>
</div>

<table class="table table-bordered bg-white text-center shadow-sm">
    <thead class="table-dark">
        <tr>
            <th>统计日期</th>
            <th>尖峰用量</th>
            <th>高峰用量</th>
            <th>平段用量</th>
            <th>低谷用量</th>
            <th>总能耗 (kWh)</th>
            <th>平均电价 (元)</th>
            <th>总成本 (元)</th>
        </tr>
    </thead>
    <tbody>
        {% for r in reports %}
        <tr>
            <td>{{ r.stat_date }}</td>
            <td class="text-danger">{{ r.sharp_value }}</td>
            <td class="text-warning">{{ r.high_value }}</td> <td class="text-primary">{{ r.flat_value }}</td>
            <td class="text-success">{{ r.low_value }}</td>
            <td class="fw-bold">{{ r.total_value }}</td>
            <td>{{ r.price_per_unit }}</td>
            <td class="fw-bold text-danger fs-5">¥ {{ r.total_cost }}</td>
        </tr>
        {% else %}
        <tr><td colspan="8" class="text-muted py-5">请选择厂区和日期进行查询</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}